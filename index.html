<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"><title>BUBBLE SHOOTER</title><style>*{margin:0;padding:0;box-sizing:border-box}html,body{width:100%;height:100%;background:#ff006e}body{overflow:hidden;touch-action:none;background:linear-gradient(135deg,#ff006e 0%,#fb5607 25%,#ffbe0b 50%,#00d9ff 75%,#00ff88 100%);background-attachment:fixed}#gameWrap{width:100%;height:100%;display:flex;flex-direction:column}#topBar{padding:10px;background:rgba(0,0,0,0.1);display:flex;justify-content:center;gap:50px;color:#fff;flex-shrink:0}.stat{text-align:center}.stat-label{font-size:10px;color:#fff;font-weight:bold}.stat-val{font-size:28px;font-weight:bold;color:#fff;text-shadow:2px 2px 4px rgba(0,0,0,0.5)}#cvs{flex:1;display:block;width:100%;height:100%;background:linear-gradient(135deg,#ff006e 0%,#fb5607 25%,#ffbe0b 50%,#00d9ff 75%,#00ff88 100%);background-attachment:fixed}#modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:40px;border-radius:20px;text-align:center;display:none;z-index:2000;border:3px solid #ffbe0b}#modal h1{color:#ffbe0b;font-size:40px;margin-bottom:20px}#modal p{color:#fff;font-size:18px;margin:12px 0}#btn{background:linear-gradient(135deg,#ff006e,#fb5607);color:#fff;border:none;padding:15px 35px;font-size:16px;border-radius:10px;cursor:pointer;margin-top:20px;font-weight:bold;transition:transform 0.2s}#btn:hover{transform:scale(1.1)}</style></head><body><div id="gameWrap"><div id="topBar"><div class="stat"><div class="stat-label">SCORE</div><div class="stat-val" id="score">0</div></div><div class="stat"><div class="stat-label">MOVES</div><div class="stat-val" id="moves">30</div></div></div><canvas id="cvs"></canvas><div id="modal"><h1>GAME OVER!</h1><p>Score: <span id="fs">0</span></p><p>Best: <span id="bs">0</span></p><button id="btn">PLAY</button></div></div><script src="https://telegram.org/js/telegram-web-app.js"></script><script>if(window.Telegram&&window.Telegram.WebApp){Telegram.WebApp.ready();Telegram.WebApp.expand();}const c=document.getElementById('cvs');const ctx=c.getContext('2d');const scoreEl=document.getElementById('score');const movesEl=document.getElementById('moves');const modal=document.getElementById('modal');const fsEl=document.getElementById('fs');const bsEl=document.getElementById('bs');const btn=document.getElementById('btn');const rows=6,cols=6;const colors=['#FF1493','#FF69B4','#FFD700','#00CED1','#32CD32','#FF6347','#4169E1','#FF8C00'];let width,height,R,balls=[],popAnims=[],score=0,moves=30,shooter={x:0,y:0,color:0},animating=false;function init(){width=c.width=window.innerWidth;height=c.height=window.innerHeight;R=Math.min(width/(cols*1.2),height/(rows*1.2))/2;R=Math.max(R,18);shooter.y=height-R*3;balls=[];popAnims=[];for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){let col=Math.floor(Math.random()*colors.length);let p=getPos(r,c);if(p.x>0&&p.x<width&&p.y>0&&p.y<height){balls.push({r,c,x:p.x,y:p.y,col})}}}shooter.color=Math.floor(Math.random()*colors.length);shooter.x=width/2;score=0;moves=30;updateUI();modal.style.display='none';gameLoop();}function getPos(r,c){let s=R*2.2;let sx=(width-cols*s)/2;let sy=(height-rows*s)/2;return{x:sx+c*s+R,y:sy+r*s+R}}function updateUI(){scoreEl.textContent=score;movesEl.textContent=moves}function gameLoop(){ctx.clearRect(0,0,width,height);balls.forEach(b=>{drawBall(b.x,b.y,b.col,R)});popAnims.forEach((a,i)=>{let p=a.t/a.d;if(p>=1){popAnims.splice(i,1);return}let sc=1+p*0.4;let al=1-p;ctx.save();ctx.globalAlpha=al;drawBall(a.x,a.y,a.col,R*sc);ctx.restore();a.t+=16});drawBall(shooter.x,shooter.y,shooter.color,R*1.1);requestAnimationFrame(gameLoop)}function drawBall(x,y,idx,r){ctx.fillStyle=colors[idx%colors.length];ctx.beginPath();ctx.arc(x,y,r*0.85,0,2*Math.PI);ctx.fill();ctx.strokeStyle='#fff';ctx.lineWidth=Math.max(2,r*0.15);ctx.stroke()}function getNeighbors(idx){let b=balls[idx],near=[];for(let i=0;i<balls.length;i++){if(i!==idx&&b.col===balls[i].col){let d=Math.hypot(balls[i].x-b.x,balls[i].y-b.y);if(d<R*2.3)near.push(i)}}return near}function getGroup(idx){let vis=new Set(),q=[idx],g=[];while(q.length){let i=q.shift();if(vis.has(i))continue;vis.add(i);g.push(i);getNeighbors(i).forEach(n=>{if(!vis.has(n))q.push(n)})}return g}function shoot(mx,my){if(animating||moves<=0)return;animating=true;let dx=mx-shooter.x,dy=my-shooter.y,dist=Math.hypot(dx,dy);if(dist<10){animating=false;return}let vx=dx/dist*6,vy=dy/dist*6,bx=shooter.x,by=shooter.y,bc=shooter.color;let t=setInterval(()=>{bx+=vx;by+=vy;if(bx<R||bx>width-R)vx=-vx;let hit=-1;for(let i=0;i<balls.length;i++){let d=Math.hypot(bx-balls[i].x,by-balls[i].y);if(d<R*2){hit=i;break}}if(hit>=0){clearInterval(t);let row=Math.round(by/(R*2.2));row=Math.max(0,Math.min(row,rows-1));let bestCol=-1,bestDist=999;for(let c=0;c<cols;c++){let p=getPos(row,c);let d=Math.abs(p.x-bx);if(d<bestDist&&!balls.find(b=>b.r===row&&b.c===c)){bestDist=d;bestCol=c}}if(bestCol>=0){let p=getPos(row,bestCol);balls.push({r:row,c:bestCol,x:p.x,y:p.y,col:bc});let grp=getGroup(balls.length-1);if(grp.length>=3){let ids=grp.sort((a,b)=>b-a);ids.forEach(i=>{let b=balls[i];popAnims.push({x:b.x,y:b.y,col:b.col,t:0,d:400});balls.splice(i,1)});score+=grp.length*10;updateUI()}}moves--;updateUI();shooter.color=Math.floor(Math.random()*colors.length);animating=false;if(moves<=0)endGame();return}if(by<-R){clearInterval(t);animating=false}},30)}function endGame(){let best=parseInt(localStorage.getItem('bs')||'0');if(score>best){best=score;localStorage.setItem('bs',best)}fsEl.textContent=score;bsEl.textContent=best;modal.style.display='block'}btn.onclick=init;c.onclick=e=>shoot(e.clientX,e.clientY);c.ontouchstart=e=>{e.preventDefault();let t=e.touches[0];shoot(t.clientX,t.clientY)};window.onresize=init;init();</script></body></html>
