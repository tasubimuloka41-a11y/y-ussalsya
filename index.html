<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"><title>BUBBLE</title><style>*{margin:0;padding:0}html,body{width:100%;height:100%}body{background:linear-gradient(135deg,#FF00FF,#00FFFF,#FFFF00,#FF0080);overflow:hidden}canvas{display:block}#ui{position:fixed;top:5px;left:50%;transform:translateX(-50%);color:#fff;font-weight:bold;font-size:20px;text-shadow:0 0 5px #000;z-index:10}</style></head><body><div id="ui">SCORE: <span id="s">0</span> | MOVES: <span id="m">30</span></div><canvas id="c"></canvas><script src="https://telegram.org/js/telegram-web-app.js"></script><script>try{Telegram.WebApp.ready();Telegram.WebApp.expand()}catch(e){}const c=document.getElementById('c'),x=c.getContext('2d');c.width=window.innerWidth;c.height=window.innerHeight;const cols=6,rows=8,sz=40;const col=['#FF0000','#00FF00','#0000FF','#FFFF00','#FF00FF','#00FFFF','#FF6600'];let grid=[],score=0,moves=30;function init(){grid=[];for(let r=0;r<rows;r++){grid[r]=[];for(let c=0;c<cols;c++){grid[r][c]=Math.floor(Math.random()*col.length)}}score=0;moves=30;document.getElementById('s').innerText=score;document.getElementById('m').innerText=moves;draw()}function getPos(r,c){return{x:c*sz+50,y:r*sz+80}}function draw(){x.fillStyle='transparent';x.clearRect(0,0,c.width,c.height);for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){if(grid[r][c]>=0){let p=getPos(r,c);x.fillStyle=col[grid[r][c]];x.beginPath();x.arc(p.x,p.y,16,0,Math.PI*2);x.fill()}}}x.fillStyle='#FF1493';x.beginPath();x.arc(c.width/2,c.height-40,18,0,Math.PI*2);x.fill()}function findMatch(sr,sc){let clr=grid[sr][sc];if(clr<0)return[];let vis=new Set(),q=[[sr,sc]],res=[];while(q.length){let[r,c]=q.shift();if(r<0||r>=rows||c<0||c>=cols)continue;let id=r*100+c;if(vis.has(id)||grid[r][c]!==clr)continue;vis.add(id);res.push([r,c]);q.push([r-1,c],[r+1,c],[r,c-1],[r,c+1])}return res}function shoot(tx,ty){if(moves<=0)return;let sx=c.width/2,sy=c.height-40,dx=tx-sx,dy=ty-sy,d=Math.sqrt(dx*dx+dy*dy);if(d<5)return;let vx=dx/d*7,vy=dy/d*7,bx=sx,by=sy;let intvl=setInterval(()=>{bx+=vx;by+=vy;if(bx<0||bx>c.width||by<0||by>c.height){clearInterval(intvl);moves--;document.getElementById('m').innerText=moves;return}let hit=-1;for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){if(grid[r][c]>=0){let p=getPos(r,c);let dst=Math.sqrt((bx-p.x)**2+(by-p.y)**2);if(dst<20){hit=r*100+c;break}}if(hit>=0)break}if(hit>=0){clearInterval(intvl);let hr=Math.floor(hit/100),hc=hit%100;let xr=-1,xc=-1;for(let r=rows-1;r>=0;r--){for(let c=0;c<cols;c++){if(grid[r][c]<0){xr=r;xc=c;break}}if(xr>=0)break}if(xr<0){intvl=0;moves--;document.getElementById('m').innerText=moves;return}grid[xr][xc]=grid[hr][hc];let matches=findMatch(xr,xc);if(matches.length>=3){matches.forEach(([r,c])=>{grid[r][c]=-1});score+=matches.length*10;document.getElementById('s').innerText=score}moves--;document.getElementById('m').innerText=moves;draw();if(moves<=0)alert('END Score: '+score);return}draw()},30)}c.onclick=e=>shoot(e.clientX,e.clientY);c.ontouchstart=e=>{e.preventDefault();shoot(e.touches[0].clientX,e.touches[0].clientY)};window.onresize=()=>{c.width=window.innerWidth;c.height=window.innerHeight;draw()};init();</script></body></html>
