<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"><title>BUBBLE SHOOTER</title><style>*{margin:0;padding:0;box-sizing:border-box}body{width:100%;height:100%;background:#2a2a2a;font-family:Arial,sans-serif;overflow:hidden;touch-action:none}#gameWrap{width:100%;height:100%;position:relative;display:flex;flex-direction:column;background:#2a2a2a}#topBar{width:100%;padding:10px 20px;background:#1a1a1a;display:flex;justify-content:center;align-items:center;gap:40px;border-bottom:2px solid #444}#topBar .score-box{display:flex;flex-direction:column;align-items:center;color:#fff}.score-lbl{font-size:11px;color:#aaa;font-weight:bold}.score-val{font-size:28px;font-weight:bold;color:#4ade80}#cvs{display:block;width:100%;flex:1;background:#2a2a2a}#modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:40px;border-radius:15px;text-align:center;display:none;z-index:2000;border:2px solid #4ade80;min-width:280px}#modal h1{color:#4ade80;font-size:36px;margin-bottom:20px}#modal p{color:#fff;font-size:18px;margin:10px 0}#btn{background:#4ade80;color:#000;border:none;padding:12px 30px;font-size:16px;border-radius:8px;cursor:pointer;margin-top:20px;font-weight:bold;transition:transform 0.2s}#btn:hover{transform:scale(1.1)}</style></head><body><div id="gameWrap"><div id="topBar"><div class="score-box"><div class="score-lbl">SCORE</div><div class="score-val" id="sc">0</div></div><div class="score-box"><div class="score-lbl">MOVES</div><div class="score-val" id="mv">30</div></div></div><canvas id="cvs"></canvas><div id="modal"><h1>GAME OVER!</h1><p>Score: <span id="fs">0</span></p><p>Best: <span id="bs">0</span></p><button id="btn">NEW GAME</button></div></div><script src="https://telegram.org/js/telegram-web-app.js"></script><script>let tg=window.Telegram?.WebApp;if(tg){tg.ready();tg.expand();}const c=document.getElementById('cvs'),ctx=c.getContext('2d'),scD=document.getElementById('sc'),mvD=document.getElementById('mv'),mod=document.getElementById('modal'),fsD=document.getElementById('fs'),bsD=document.getElementById('bs'),btn=document.getElementById('btn');let W,H,R,rows=7,cols=6,balls=[],popAnimations=[],shooter={x:0,y:0,color:null},sc=0,mv=30,bs=localStorage.getItem('bs')||0,colors=['#FF3333','#3366FF','#33FF33','#FFFF33','#FF99FF','#FF6633','#00FFFF','#FF0099'],animating=false;function resize(){W=c.width=window.innerWidth;H=c.height=window.innerHeight;R=Math.min(W,H)/18;shooter.y=H-R*2.5;}function getPos(r,c){return{x:c*R*2.2+R*1.3,y:r*R*2.2+R*1.3};}function init(){resize();balls=[];popAnimations=[];for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){let pos=getPos(r,c);balls.push({r,c,x:pos.x,y:pos.y,color:colors[Math.floor(Math.random()*colors.length)]});}}shooter.color=colors[Math.floor(Math.random()*colors.length)];shooter.x=W/2;sc=0;mv=30;scD.textContent=sc;mvD.textContent=mv;mod.style.display='none';animate();}function animate(){requestAnimationFrame(animate);draw();}function draw(){ctx.fillStyle='#2a2a2a';ctx.fillRect(0,0,W,H);balls.forEach(b=>{ctx.fillStyle=b.color;ctx.beginPath();ctx.arc(b.x,b.y,R*0.9,0,Math.PI*2);ctx.fill();ctx.strokeStyle='#fff';ctx.lineWidth=2;ctx.stroke();});popAnimations.forEach((p,i)=>{let progress=p.time/p.duration;if(progress>=1){popAnimations.splice(i,1);return;}let scale=1+progress*0.5;let alpha=1-progress;ctx.save();ctx.globalAlpha=alpha;ctx.fillStyle=p.color;ctx.beginPath();ctx.arc(p.x,p.y,R*0.9*scale,0,Math.PI*2);ctx.fill();ctx.restore();p.time+=16;});ctx.fillStyle=shooter.color;ctx.beginPath();ctx.arc(shooter.x,shooter.y,R,0,Math.PI*2);ctx.fill();ctx.strokeStyle='#fff';ctx.lineWidth=3;ctx.stroke();}function getNearby(idx){let ball=balls[idx];let nearby=[];for(let i=0;i<balls.length;i++){if(i===idx)continue;let d=Math.sqrt((balls[i].x-ball.x)**2+(balls[i].y-ball.y)**2);if(d<R*2.1&&balls[i].color===ball.color){nearby.push(i);}}return nearby;}function getConnected(idx){let visited=new Set(),toVisit=[idx],group=[];while(toVisit.length){let i=toVisit.pop();if(visited.has(i))continue;visited.add(i);group.push(i);getNearby(i).forEach(n=>{if(!visited.has(n))toVisit.push(n);});}return group;}function shoot(tx,ty){if(animating||mv<=0)return;animating=true;let dx=tx-shooter.x,dy=ty-shooter.y,dist=Math.sqrt(dx*dx+dy*dy);if(dist===0)return;let vx=dx/dist*8,vy=dy/dist*8,bx=shooter.x,by=shooter.y,bc=shooter.color;let interval=setInterval(()=>{bx+=vx;by+=vy;if(bx<R||bx>W-R)vx=-vx;let hit=-1;for(let i=0;i<balls.length;i++){let d=Math.sqrt((bx-balls[i].x)**2+(by-balls[i].y)**2);if(d<R*1.8){hit=i;break;}}if(hit>=0){clearInterval(interval);let targetRow=Math.round(by/(R*2.2));if(targetRow<0)targetRow=0;if(targetRow>=rows)targetRow=rows-1;let bestCol=-1,bestDist=999;for(let c=0;c<cols;c++){let x=c*R*2.2+R*1.3;let d=Math.abs(x-bx);if(d<bestDist&&!balls.find(b=>b.r===targetRow&&b.c===c)){bestDist=d;bestCol=c;}}if(bestCol>=0){balls.push({r:targetRow,c:bestCol,x:bestCol*R*2.2+R*1.3,y:targetRow*R*2.2+R*1.3,color:bc});let lastIdx=balls.length-1;let group=getConnected(lastIdx);if(group.length>=3){let removeIndices=[...group].sort((a,b)=>b-a);removeIndices.forEach(i=>{let b=balls[i];popAnimations.push({x:b.x,y:b.y,color:b.color,time:0,duration:400});balls.splice(i,1);});sc+=group.length*10;scD.textContent=sc;}}mv--;mvD.textContent=mv;shooter.color=colors[Math.floor(Math.random()*colors.length)];animating=false;if(mv<=0)gameOver();return;}if(by<0){clearInterval(interval);animating=false;}},30);}function gameOver(){if(sc>bs){bs=sc;localStorage.setItem('bs',bs);}fsD.textContent=sc;bsD.textContent=bs;mod.style.display='block';}btn.onclick=()=>{init();};c.onclick=e=>shoot(e.clientX,e.clientY);c.ontouchstart=e=>{e.preventDefault();let touch=e.touches[0];shoot(touch.clientX,touch.clientY);};window.onresize=()=>{resize();draw();};init();</script></body></html>
