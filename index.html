<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>üéÆ BUBBLE SHOOTER PREMIUM</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{width:100vw;height:100vh;overflow:hidden;font-family:Arial,sans-serif;background:linear-gradient(-45deg,#FF1744,#FF6F00,#00E676,#00B0FF,#D500F9);background-size:400% 400%;animation:gradient 15s ease infinite;position:relative}
@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
#stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0}
.star{position:absolute;background:#fff;border-radius:50%;animation:twinkle 3s infinite}
@keyframes twinkle{0%,100%{opacity:0.3}50%{opacity:1}}
#menu,#game,#leaderboard{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;text-align:center;color:#fff;display:none}
#menu.active,#game.active,#leaderboard.active{display:block}
h1{font-size:48px;font-weight:bold;margin-bottom:40px;text-shadow:3px 3px 6px rgba(0,0,0,0.3)}
button{font-family:Arial,sans-serif;font-size:20px;font-weight:bold;padding:18px 45px;margin:15px;background:linear-gradient(135deg,#FF1744 0%,#F50057 100%);color:#fff;border:none;border-radius:50px;cursor:pointer;text-shadow:1px 1px 2px rgba(0,0,0,0.3);box-shadow:0 8px 15px rgba(0,0,0,0.3);transition:all 0.3s;text-transform:uppercase;letter-spacing:1px}
button:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 12px 20px rgba(0,0,0,0.4)}
button:active{transform:translateY(-1px);box-shadow:0 5px 10px rgba(0,0,0,0.2)}
#gameCanvas{border:none;background:transparent}
#score,#highScore{font-size:24px;font-weight:bold;margin:15px;text-shadow:2px 2px 4px rgba(0,0,0,0.3)}
#leaderboard table{margin:20px auto;border-collapse:collapse;background:rgba(255,255,255,0.1);border-radius:15px;overflow:hidden}
#leaderboard td{padding:12px 25px;border-bottom:1px solid rgba(255,255,255,0.1);font-size:18px}
#leaderboard tr:first-child td{background:rgba(255,255,255,0.2);font-weight:bold}
.player-input{font-family:Arial,sans-serif;font-size:18px;padding:12px;margin:10px;border:2px solid rgba(255,255,255,0.5);border-radius:25px;text-align:center;background:rgba(255,255,255,0.9)}
</style>
</head>
<body>
<div id="stars"></div>
<div id="menu" class="active">
<h1>üéÆ BUBBLE SHOOTER</h1>
<button id="playBtn">–ò–ì–†–ê–¢–¨</button>
<button id="recordsBtn">–†–ï–ö–û–†–î–´</button>
</div>
<div id="game">
<div id="score">–û—á–∫–∏: 0</div>
<div id="highScore">–†–µ–∫–æ—Ä–¥: 0</div>
<canvas id="gameCanvas" width="600" height="600"></canvas><br>
<button id="menuBtn">–ú–ï–ù–Æ</button>
</div>
<div id="leaderboard">
<h1>üèÜ –†–ï–ö–û–†–î–´</h1>
<table id="leaderboardTable"></table><br>
<button id="backBtn">–ù–ê–ó–ê–î</button>
</div>
<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
const EMOJIS=['üòÄ','üòÇ','üòç','üòé','ü•≥','üòò','üòã','ü§©'];
const COLORS=['#FF1744','#FF6F00','#00E676','#00B0FF','#D500F9','#FFEA00','#00E5FF','#FF4081'];
const ROWS=10;
const COLS=10;
const SIZE=60;
let grid=[];
let score=0;
let highScore=localStorage.getItem('highScore')||0;
let currentBall={x:300,y:550,color:null,emoji:null};

function initGrid(){
for(let r=0;r<5;r++){
grid[r]=[];
for(let c=0;c<COLS;c++){
let idx=Math.floor(Math.random()*COLORS.length);
grid[r][c]={color:COLORS[idx],emoji:EMOJIS[idx]};
}
}
for(let r=5;r<ROWS;r++){grid[r]=[];for(let c=0;c<COLS;c++){grid[r][c]=null}}
}

function drawBall(x,y,color,emoji){
if(!color)return;
ctx.beginPath();
ctx.arc(x,y,SIZE/2-5,0,Math.PI*2);
ctx.fillStyle=color;
ctx.fill();
ctx.shadowColor='rgba(0,0,0,0.3)';
ctx.shadowBlur=10;
ctx.shadowOffsetX=3;
ctx.shadowOffsetY=3;
if(emoji){
ctx.shadowBlur=0;
ctx.shadowOffsetX=0;
ctx.shadowOffsetY=0;
ctx.font='30px Arial';
ctx.textAlign='center';
ctx.textBaseline='middle';
ctx.fillText(emoji,x,y);
}
}

function draw(){
ctx.clearRect(0,0,600,600);
for(let r=0;r<ROWS;r++){
for(let c=0;c<COLS;c++){
if(grid[r]&&grid[r][c]){
drawBall(c*SIZE+SIZE/2,r*SIZE+SIZE/2,grid[r][c].color,grid[r][c].emoji);
}
}
}
if(currentBall.color){
drawBall(currentBall.x,currentBall.y,currentBall.color,currentBall.emoji);
}
}

function findMatches(row,col){
if(!grid[row]||!grid[row][col])return[];
const color=grid[row][col].color;
const visited=[];
const matches=[];

function dfs(r,c){
if(r<0||r>=ROWS||c<0||c>=COLS)return;
if(!grid[r]||!grid[r][c]||grid[r][c].color!==color)return;
const key=r+','+c;
if(visited[key])return;
visited[key]=true;
matches.push({r,c});
dfs(r-1,c);dfs(r+1,c);dfs(r,c-1);dfs(r,c+1);
}

dfs(row,col);
return matches;
}

function removeBubbles(matches){
matches.forEach(({r,c})=>{
if(grid[r])grid[r][c]=null;
});
return matches.length;
}

function checkGameOver(){
for(let c=0;c<COLS;c++){
if(grid[ROWS-1]&&grid[ROWS-1][c]){
return true;
}
}
return false;
}

canvas.onclick=(e)=>{
if(!currentBall.color)return;
let rect=canvas.getBoundingClientRect();
let clickX=e.clientX-rect.left;
let clickY=e.clientY-rect.top;
let ballX=currentBall.x;
let ballY=currentBall.y;
if(ballX<30){ballX=30}
if(ballX>570){ballX=570}
let c=Math.floor((ballX-0.3)/SIZE);
let r=Math.floor((ballY+25)/SIZE);
if(r<0)r=0;
if(r>=ROWS)r=ROWS-1;
if(c<0)c=0;
if(c>=COLS)c=COLS-1;
if(!grid[r])grid[r]=[];
let placed=false;
while(r<ROWS&&!placed){
if(r==0||c<0||c>=COLS||!grid[r]){
if(!grid[r])grid[r]=[];
grid[r][c]={color:currentBall.color,emoji:currentBall.emoji};
placed=true;
break;
}
if(r>=1&&grid[r-1]&&grid[r-1][c]){
if(!grid[r])grid[r]=[];
grid[r][c]={color:currentBall.color,emoji:currentBall.emoji};
placed=true;
break;
}
r++;
}
if(placed){
let matches=findMatches(r,c);
if(matches.length>=3){
let removed=removeBubbles(matches);
score+=removed*10;
document.getElementById('score').textContent='–û—á–∫–∏: '+score;
}
if(checkGameOver()){
endGame();
return;
}
let idx=Math.floor(Math.random()*COLORS.length);
currentBall.color=COLORS[idx];
currentBall.emoji=EMOJIS[idx];
draw();
}
};

function startGame(){
document.getElementById('menu').classList.remove('active');
document.getElementById('game').classList.add('active');
initGrid();
score=0;
document.getElementById('score').textContent='–û—á–∫–∏: 0';
document.getElementById('highScore').textContent='–†–µ–∫–æ—Ä–¥: '+highScore;
let idx=Math.floor(Math.random()*COLORS.length);
currentBall.color=COLORS[idx];
currentBall.emoji=EMOJIS[idx];
draw();
}

function backToMenu(){
document.getElementById('game').classList.remove('active');
document.getElementById('leaderboard').classList.remove('active');
document.getElementById('menu').classList.add('active');
}

function endGame(){
if(score>highScore){
highScore=score;
localStorage.setItem('highScore',highScore);
}
let name=prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:','Player');
if(name&&score>0){
let records=JSON.parse(localStorage.getItem('records'))||[];
records.push({name,score,date:new Date().toLocaleDateString()});
records.sort((a,b)=>b.score-a.score).slice(0,10);
localStorage.setItem('records',JSON.stringify(records));
}
showLeaderboard();
}

function showLeaderboard(){
let records=JSON.parse(localStorage.getItem('records'))||[];
let table=document.getElementById('leaderboardTable');
table.innerHTML='<tr><td>#{}</td><td>–ò–º—è</td><td>–û—á–∫–∏</td><td>–î–∞—Ç–∞</td></tr>';
records.slice(0,10).forEach((r,i)=>{
table.innerHTML+='<tr><td>'+(i+1)+'</td><td>'+r.name+'</td><td>'+r.score+'</td><td>'+r.date+'</td></tr>';
});
document.getElementById('game').classList.remove('active');
document.getElementById('menu').classList.remove('active');
document.getElementById('leaderboard').classList.add('active');
}

for(let i=0;i<100;i++){
const star=document.createElement('div');
star.className='star';
star.style.width=star.style.height=Math.random()*3+'px';
star.style.left=Math.random()*100+'%';
star.style.top=Math.random()*100+'%';
document.getElementById('stars').appendChild(star);
}

document.getElementById('playBtn').addEventListener('click',startGame);
document.getElementById('recordsBtn').addEventListener('click',showLeaderboard);
document.getElementById('menuBtn').addEventListener('click',backToMenu);
document.getElementById('backBtn').addEventListener('click',backToMenu);
</script>
</body>
</html>
