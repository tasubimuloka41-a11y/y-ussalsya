<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>üéÆ BUBBLE SHOOTER PREMIUM</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{width:100vw;height:100vh;overflow:hidden;font-family:Arial,sans-serif;background:#1a0033;position:relative}
#starfield{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;background:linear-gradient(135deg,#1a0033 0%,#2d1b4e 50%,#1a0033 100%)}
#game-container{position:relative;width:100vw;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1}
#score{font-size:48px;font-weight:bold;color:#fff;text-shadow:0 0 20px #ff00ff,0 0 40px #00ffff;margin-bottom:20px;animation:pulse 2s infinite}
#game-canvas{border:5px solid #ff00ff;box-shadow:0 0 40px #ff00ff,inset 0 0 40px rgba(255,0,255,0.3);background:linear-gradient(180deg,rgba(138,43,226,0.4) 0%,rgba(75,0,130,0.4) 100%);max-width:100vw;max-height:80vh}
#next-bubble-container{margin-top:20px;text-align:center}
#next-label{font-size:32px;color:#fff;text-shadow:0 0 10px #00ffff;margin-bottom:10px}
#next-bubble{width:80px;height:80px;border-radius:50%;border:4px solid #fff;box-shadow:0 0 30px #00ffff}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
</style>
</head>
<body>
<canvas id="starfield"></canvas>
<div id="game-container">
<div id="score">–û—á–∫–∏: 0</div>
<canvas id="game-canvas"></canvas>
<div id="next-bubble-container">
<div id="next-label">–°–ª–µ–¥—É—é—â–∏–π:</div>
<canvas id="next-bubble"></canvas>
</div>
</div>
<script>
const canvas=document.getElementById('game-canvas');
const ctx=canvas.getContext('2d');
const nextCanvas=document.getElementById('next-bubble');
const nextCtx=nextCanvas.getContext('2d');
const starCanvas=document.getElementById('starfield');
const starCtx=starCanvas.getContext('2d');
canvas.width=Math.min(window.innerWidth-40,600);
canvas.height=Math.min(window.innerHeight*0.7,800);
starCanvas.width=window.innerWidth;
starCanvas.height=window.innerHeight;
nextCanvas.width=80;
nextCanvas.height=80;
const COLORS=['#00ffff','#ff1493','#9400ff','#00ff00','#ffd700'];
const ROWS=8;
const COLS=11;
const RADIUS=Math.min(canvas.width/COLS/2,30);
let score=0;
let grid=[];
let currentBall=null;
let nextBall=null;
let particles=[];
let stars=[];
class Star{constructor(){this.x=Math.random()*starCanvas.width;this.y=Math.random()*starCanvas.height;this.size=Math.random()*3+1;this.speed=Math.random()*2+1;this.opacity=Math.random()}update(){this.y+=this.speed;if(this.y>starCanvas.height){this.y=0;this.x=Math.random()*starCanvas.width}this.opacity=Math.sin(Date.now()*0.001+this.x)*0.5+0.5}draw(){starCtx.fillStyle=`rgba(255,255,255,${this.opacity})`;starCtx.beginPath();starCtx.arc(this.x,this.y,this.size,0,Math.PI*2);starCtx.fill()}}
for(let i=0;i<200;i++){stars.push(new Star())}
function animateStars(){starCtx.clearRect(0,0,starCanvas.width,starCanvas.height);starCtx.fillStyle='rgba(26,0,51,0.1)';starCtx.fillRect(0,0,starCanvas.width,starCanvas.height);stars.forEach(star=>{star.update();star.draw()})}
class Particle{constructor(x,y,color){this.x=x;this.y=y;this.vx=(Math.random()-0.5)*15;this.vy=(Math.random()-0.5)*15-5;this.life=1;this.color=color;this.size=Math.random()*8+4}update(){this.x+=this.vx;this.y+=this.vy;this.vy+=0.5;this.life-=0.02;this.vx*=0.98}draw(){if(this.life>0){ctx.globalAlpha=this.life;ctx.fillStyle=this.color;ctx.shadowBlur=20;ctx.shadowColor=this.color;ctx.beginPath();ctx.arc(this.x,this.y,this.size,0,Math.PI*2);ctx.fill();ctx.shadowBlur=0;ctx.globalAlpha=1}}}
function createExplosion(x,y,color){const audioCtx=new AudioContext();const osc=audioCtx.createOscillator();osc.frequency.value=880;osc.connect(audioCtx.destination);osc.start();osc.stop(audioCtx.currentTime+0.1);for(let i=0;i<25;i++){particles.push(new Particle(x,y,color))}}
function drawBall(x,y,color,context=ctx,r=RADIUS){const gradient=context.createRadialGradient(x-r*0.3,y-r*0.3,0,x,y,r);gradient.addColorStop(0,'#ffffff');gradient.addColorStop(0.3,color);gradient.addColorStop(1,shadeColor(color,-30));context.fillStyle=gradient;context.shadowBlur=15;context.shadowColor=color;context.beginPath();context.arc(x,y,r,0,Math.PI*2);context.fill();context.shadowBlur=0;context.strokeStyle='rgba(255,255,255,0.5)';context.lineWidth=2;context.beginPath();context.arc(x-r*0.25,y-r*0.25,r*0.3,0,Math.PI*2);context.stroke()}
function shadeColor(color,percent){const num=parseInt(color.replace('#',''),16);const amt=Math.round(2.55*percent);const R=(num>>16)+amt;const G=(num>>8&0x00FF)+amt;const B=(num&0x0000FF)+amt;return'#'+(0x1000000+(R<255?R<1?0:R:255)*0x10000+(G<255?G<1?0:G:255)*0x100+(B<255?B<1?0:B:255)).toString(16).slice(1)}
function initGrid(){for(let row=0;row<ROWS;row++){grid[row]=[];for(let col=0;col<COLS;col++){if(row<5){const offset=row%2===0?0:RADIUS;grid[row][col]={x:RADIUS+col*RADIUS*2+offset,y:RADIUS+row*RADIUS*1.8,color:COLORS[Math.floor(Math.random()*COLORS.length)]}}else{grid[row][col]=null}}}}
function drawGrid(){grid.forEach(row=>{row.forEach(cell=>{if(cell){drawBall(cell.x,cell.y,cell.color)}})})}
function createNewBall(){return{x:canvas.width/2,y:canvas.height-RADIUS-10,color:COLORS[Math.floor(Math.random()*COLORS.length)],vx:0,vy:0}}
function drawCurrentBall(){if(currentBall){drawBall(currentBall.x,currentBall.y,currentBall.color)}}
function drawNextBall(){if(nextBall){nextCtx.clearRect(0,0,nextCanvas.width,nextCanvas.height);drawBall(40,40,nextBall.color,nextCtx,35)}}
function findMatches(row,col){if(!grid[row]||!grid[row][col])return[];const color=grid[row][col].color;const visited=new Set();const matches=[];function dfs(r,c){const key=`${r},${c}`;if(visited.has(key))return;if(r<0||r>=ROWS||c<0||c>=COLS)return;if(!grid[r]||!grid[r][c]||grid[r][c].color!==color)return;visited.add(key);matches.push({r,c});const offset=r%2===0?0:1;dfs(r-1,c);dfs(r-1,c-1+offset);dfs(r+1,c);dfs(r+1,c-1+offset);dfs(r,c-1);dfs(r,c+1)}dfs(row,col);return matches}
canvas.addEventListener('click',e=>{if(!currentBall||currentBall.vy!==0)return;const rect=canvas.getBoundingClientRect();const clickX=e.clientX-rect.left;const clickY=e.clientY-rect.top;const dx=clickX-currentBall.x;const dy=clickY-currentBall.y;const dist=Math.sqrt(dx*dx+dy*dy);currentBall.vx=(dx/dist)*15;currentBall.vy=(dy/dist)*15;const audioCtx=new AudioContext();const osc=audioCtx.createOscillator();osc.frequency.value=440;osc.connect(audioCtx.destination);osc.start();osc.stop(audioCtx.currentTime+0.05)});
function gameLoop(){ctx.clearRect(0,0,canvas.width,canvas.height);animateStars();drawGrid();particles=particles.filter(p=>{p.update();p.draw();return p.life>0});if(currentBall&&currentBall.vy!==0){currentBall.x+=currentBall.vx;currentBall.y+=currentBall.vy;if(currentBall.x-RADIUS<0||currentBall.x+RADIUS>canvas.width){currentBall.vx*=-1}if(currentBall.y-RADIUS<=0){const col=Math.max(0,Math.min(COLS-1,Math.round((currentBall.x-RADIUS)/(RADIUS*2))));grid[0][col]={x:RADIUS+col*RADIUS*2,y:RADIUS,color:currentBall.color};const matches=findMatches(0,col);if(matches.length>=3){matches.forEach(m=>{createExplosion(grid[m.r][m.c].x,grid[m.r][m.c].y,grid[m.r][m.c].color);grid[m.r][m.c]=null});score+=matches.length*10;document.getElementById('score').textContent=`–û—á–∫–∏: ${score}`}currentBall=nextBall;nextBall=createNewBall();drawNextBall()}for(let row=0;row<ROWS;row++){for(let col=0;col<COLS;col++){if(grid[row][col]){const dx=currentBall.x-grid[row][col].x;const dy=currentBall.y-grid[row][col].y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<RADIUS*2){let bestRow=-1;let bestCol=-1;let minDist=999999;for(let r=0;r<ROWS;r++){for(let c=0;c<COLS;c++){if(!grid[r][c]){const offset=r%2===0?0:RADIUS;const cellX=RADIUS+c*RADIUS*2+offset;const cellY=RADIUS+r*RADIUS*1.8;const d=Math.sqrt((currentBall.x-cellX)**2+(currentBall.y-cellY)**2);if(d<minDist){minDist=d;bestRow=r;bestCol=c}}}}if(bestRow>=0&&bestCol>=0){const offset=bestRow%2===0?0:RADIUS;grid[bestRow][bestCol]={x:RADIUS+bestCol*RADIUS*2+offset,y:RADIUS+bestRow*RADIUS*1.8,color:currentBall.color};const matches=findMatches(bestRow,bestCol);if(matches.length>=3){matches.forEach(m=>{createExplosion(grid[m.r][m.c].x,grid[m.r][m.c].y,grid[m.r][m.c].color);grid[m.r][m.c]=null});score+=matches.length*10;document.getElementById('score').textContent=`–û—á–∫–∏: ${score}`}currentBall=nextBall;nextBall=createNewBall();drawNextBall()}row=ROWS;col=COLS;break}}}}}drawCurrentBall();requestAnimationFrame(gameLoop)}
initGrid();currentBall=createNewBall();nextBall=createNewBall();drawNextBall();gameLoop();
</script>
</body>
</html>
