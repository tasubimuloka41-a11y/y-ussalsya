<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"><title>BUBBLE</title><style>*{margin:0;padding:0}html,body{width:100%;height:100%}body{background:linear-gradient(135deg,#FF00FF,#00FFFF,#FFFF00,#FF0080);overflow:hidden;font-family:Arial}canvas{display:block;width:100%;height:100%}#ui{position:fixed;top:5px;left:50%;transform:translateX(-50%);color:#fff;font-weight:bold;font-size:20px;text-shadow:0 0 5px #000;z-index:10}</style></head><body><div id="ui">SCORE: <span id="s">0</span> | MOVES: <span id="m">30</span></div><canvas id="c"></canvas><script src="https://telegram.org/js/telegram-web-app.js"></script><script>try{Telegram.WebApp.ready();Telegram.WebApp.expand()}catch(e){}const c=document.getElementById('c'),x=c.getContext('2d');c.width=window.innerWidth;c.height=window.innerHeight;const cols=6,rows=8,size=40;const col=['#FF0000','#00FF00','#0000FF','#FFFF00','#FF00FF','#00FFFF','#FF6600'];let grid=[],score=0,moves=30,shot=false;function init(){grid=[];for(let r=0;r<rows;r++){grid[r]=[];for(let c=0;c<cols;c++){grid[r][c]=Math.floor(Math.random()*col.length)}}score=0;moves=30;document.getElementById('s').innerText=score;document.getElementById('m').innerText=moves;shot=false;draw()}function getPos(r,c){return{x:c*size+50,y:r*size+80}}function draw(){x.fillStyle='transparent';x.clearRect(0,0,c.width,c.height);for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){if(grid[r][c]>=0){let p=getPos(r,c);x.fillStyle=col[grid[r][c]];x.beginPath();x.arc(p.x,p.y,16,0,Math.PI*2);x.fill()}}}x.fillStyle='#FF1493';x.beginPath();x.arc(c.width/2,c.height-40,18,0,Math.PI*2);x.fill()}function findMatch(r,c){if(grid[r][c]<0)return [];let clr=grid[r][c],vis=new Set(),q=[[r,c]];while(q.length){let[cr,cc]=q.shift();if(cr<0||cr>=rows||cc<0||cc>=cols)continue;let k=cr*1000+cc;if(vis.has(k)||grid[cr][cc]!==clr)continue;vis.add(k);q.push([cr-1,cc],[cr+1,cc],[cr,cc-1],[cr,cc+1])}return Array.from(vis).map(k=>[Math.floor(k/1000),k%1000])}function shoot(tx,ty){if(shot||moves<=0)return;shot=true;let sx=c.width/2,sy=c.height-40,dx=tx-sx,dy=ty-sy,d=Math.sqrt(dx*dx+dy*dy);if(d<5){shot=false;return}let vx=dx/d*7,vy=dy/d*7,x_=sx,y_=sy;let int=setInterval(()=>{x_+=vx;y_+=vy;if(x_<0||x_>c.width||y_<0||y_>c.height){clearInterval(int);moves--;document.getElementById('m').innerText=moves;shot=false;if(moves<=0)alert('GAME OVER! Score: '+score);return}let hit=-1;for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){if(grid[r][c]>=0){let p=getPos(r,c);let dist=Math.sqrt((x_-p.x)**2+(y_-p.y)**2);if(dist<20){hit=r*1000+c;break}}if(hit>=0)break}if(hit>=0){clearInterval(int);let hr=Math.floor(hit/1000),hc=hit%1000;let closest=-1,minD=999;for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){if(grid[r][c]<0){let p=getPos(r,c);let d=Math.abs(p.x-x_)+Math.abs(p.y-y_);if(d<minD){minD=d;closest=r*1000+c}}}}if(closest<0){for(let r=rows-1;r>=0;r--){for(let c=0;c<cols;c++){if(grid[r][c]<0){closest=r*1000+c;break}}if(closest>=0)break}};if(closest>=0){let cr=Math.floor(closest/1000),cc=closest%1000;grid[cr][cc]=grid[hr][hc];let matches=findMatch(cr,cc);if(matches.length>=3){matches.forEach(([r,c])=>{grid[r][c]=-1});score+=matches.length*10;document.getElementById('s').innerText=score}};moves--;document.getElementById('m').innerText=moves;draw();shot=false;if(moves<=0)alert('GAME OVER! Score: '+score);return};draw()},30)}c.onclick=e=>shoot(e.clientX,e.clientY);c.ontouchstart=e=>{e.preventDefault();shoot(e.touches[0].clientX,e.touches[0].clientY)};window.onresize=()=>{c.width=window.innerWidth;c.height=window.innerHeight;draw()};init();</script></body></html>
