<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"><title>BUBBLE SHOOTER</title><style>*{margin:0;padding:0;box-sizing:border-box}body{width:100vw;height:100vh;background:linear-gradient(135deg,#FF1493,#FF69B4,#FFD700,#00CED1,#32CD32);font-family:Arial,sans-serif;overflow:hidden;touch-action:none}#gameWrap{width:100%;height:100%;position:relative;display:flex;flex-direction:column;background:linear-gradient(135deg,#FF1493,#FF69B4,#FFD700,#00CED1,#32CD32)}#topBar{width:100%;padding:10px;background:rgba(0,0,0,0.2);display:flex;justify-content:center;align-items:center;gap:40px;border-bottom:4px solid #fff;flex-shrink:0}#topBar .score-box{text-align:center;color:#fff}.score-lbl{font-size:12px;color:#fff;font-weight:bold;text-shadow:2px 2px 4px rgba(0,0,0,0.6)}.score-val{font-size:32px;font-weight:bold;color:#fff;text-shadow:2px 2px 4px rgba(0,0,0,0.6)}#cvs{display:block;width:100%;flex:1;background:linear-gradient(135deg,#FF1493,#FF69B4,#FFD700,#00CED1,#32CD32);cursor:crosshair}#modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:40px;border-radius:15px;text-align:center;display:none;z-index:2000;border:3px solid #FFD700;min-width:300px;box-shadow:0 8px 32px rgba(255,215,0,0.5)}#modal h1{color:#FFD700;font-size:40px;margin-bottom:20px;text-shadow:2px 2px 6px rgba(0,0,0,0.8)}#modal p{color:#fff;font-size:18px;margin:15px 0}#btn{background:linear-gradient(135deg,#FF1493,#FF69B4);color:#fff;border:none;padding:15px 35px;font-size:16px;border-radius:10px;cursor:pointer;margin-top:25px;font-weight:bold;transition:all 0.3s;box-shadow:0 4px 15px rgba(255,20,147,0.5);}#btn:hover{transform:scale(1.15);box-shadow:0 6px 20px rgba(255,20,147,0.7)}</style></head><body><div id="gameWrap"><div id="topBar"><div class="score-box"><div class="score-lbl">SCORE</div><div class="score-val" id="sc">0</div></div><div class="score-box"><div class="score-lbl">MOVES</div><div class="score-val" id="mv">30</div></div></div><canvas id="cvs"></canvas><div id="modal"><h1>GAME OVER!</h1><p>Score: <span id="fs">0</span></p><p>Best: <span id="bs">0</span></p><button id="btn">NEW GAME</button></div></div><script src="https://telegram.org/js/telegram-web-app.js"></script><script>let tg=window.Telegram?.WebApp;if(tg){tg.ready();tg.expand();}const c=document.getElementById('cvs'),ctx=c.getContext('2d'),scD=document.getElementById('sc'),mvD=document.getElementById('mv'),mod=document.getElementById('modal'),fsD=document.getElementById('fs'),bsD=document.getElementById('bs'),btn=document.getElementById('btn');let W,H,R,rows=6,cols=6,balls=[],popAnimations=[],shooter={x:0,y:0,type:0},sc=0,mv=30,bs=localStorage.getItem('bs')||0,types=8,animating=false;function resize(){W=c.width=window.innerWidth;H=c.height=window.innerHeight;let topBarHeight=document.getElementById('topBar').offsetHeight;H-=topBarHeight;c.height=H;let maxR=Math.min(W/(cols*1.15),H/(rows*1.15))/2;R=Math.max(20,maxR);shooter.y=H-R*2.5;}function getPos(r,c){let ballW=R*2.2;let ballH=R*2.2;let offsetX=(W-cols*ballW)/2;let offsetY=(H-rows*ballH)/2;return{x:offsetX+c*ballW+R*1.1,y:offsetY+r*ballH+R*1.1};}function drawBall(x,y,type,size=R){let colors=['#FF1493','#FF69B4','#FFD700','#00CED1','#32CD32','#FF6347','#4169E1','#FF8C00'];ctx.fillStyle=colors[type%colors.length];ctx.beginPath();ctx.arc(x,y,size*0.9,0,Math.PI*2);ctx.fill();ctx.strokeStyle='#fff';ctx.lineWidth=3;ctx.stroke();}function init(){resize();balls=[];popAnimations=[];for(let r=0;r<rows;r++){for(let c=0;c<cols;c++){let pos=getPos(r,c);if(pos.x>0&&pos.x<W&&pos.y>0&&pos.y<H){balls.push({r,c,x:pos.x,y:pos.y,type:Math.floor(Math.random()*types)});}}}shooter.type=Math.floor(Math.random()*types);shooter.x=W/2;sc=0;mv=30;scD.textContent=sc;mvD.textContent=mv;mod.style.display='none';animate();}function animate(){requestAnimationFrame(animate);draw();}function draw(){ctx.fillStyle='transparent';ctx.clearRect(0,0,W,H);balls.forEach(b=>{drawBall(b.x,b.y,b.type);});popAnimations.forEach((p,i)=>{let progress=p.time/p.duration;if(progress>=1){popAnimations.splice(i,1);return;}let scale=1+progress*0.3;let alpha=1-progress;ctx.save();ctx.globalAlpha=alpha;drawBall(p.x,p.y,p.type,R*scale);ctx.restore();p.time+=16;});drawBall(shooter.x,shooter.y,shooter.type,R*1.2);}function getNearby(idx){let ball=balls[idx];let nearby=[];for(let i=0;i<balls.length;i++){if(i===idx)continue;let d=Math.hypot(balls[i].x-ball.x,balls[i].y-ball.y);if(d<R*2.3&&balls[i].type===ball.type){nearby.push(i);}}return nearby;}function getConnected(idx){let visited=new Set(),toVisit=[idx],group=[];while(toVisit.length){let i=toVisit.pop();if(visited.has(i))continue;visited.add(i);group.push(i);getNearby(i).forEach(n=>{if(!visited.has(n))toVisit.push(n);});}return group;}function shoot(tx,ty){if(animating||mv<=0)return;animating=true;tx-=c.offsetLeft||0;ty-=c.offsetTop||0;let dx=tx-shooter.x,dy=ty-shooter.y,dist=Math.hypot(dx,dy);if(dist<5){animating=false;return;}let vx=dx/dist*7,vy=dy/dist*7,bx=shooter.x,by=shooter.y,btype=shooter.type;let interval=setInterval(()=>{bx+=vx;by+=vy;if(bx<R||bx>W-R)vx=-vx;let hit=-1;for(let i=0;i<balls.length;i++){let d=Math.hypot(bx-balls[i].x,by-balls[i].y);if(d<R*1.9){hit=i;break;}}if(hit>=0){clearInterval(interval);let targetRow=Math.round(by/(R*2.2));if(targetRow<0)targetRow=0;if(targetRow>=rows)targetRow=rows-1;let bestCol=-1,bestDist=999;for(let c=0;c<cols;c++){let pos=getPos(targetRow,c);let d=Math.abs(pos.x-bx);if(d<bestDist&&!balls.find(b=>b.r===targetRow&&b.c===c)){bestDist=d;bestCol=c;}}if(bestCol>=0){let pos=getPos(targetRow,bestCol);balls.push({r:targetRow,c:bestCol,x:pos.x,y:pos.y,type:btype});let lastIdx=balls.length-1;let group=getConnected(lastIdx);if(group.length>=3){let removeIndices=[...group].sort((a,b)=>b-a);removeIndices.forEach(i=>{let b=balls[i];popAnimations.push({x:b.x,y:b.y,type:b.type,time:0,duration:400});balls.splice(i,1);});sc+=group.length*10;scD.textContent=sc;}}mv--;mvD.textContent=mv;shooter.type=Math.floor(Math.random()*types);animating=false;if(mv<=0)gameOver();return;}if(by<-R*2){clearInterval(interval);animating=false;}},25);}function gameOver(){if(sc>bs){bs=sc;localStorage.setItem('bs',bs);}fsD.textContent=sc;bsD.textContent=bs;mod.style.display='block';}btn.onclick=()=>{init();};c.onclick=e=>shoot(e.clientX,e.clientY);c.ontouchstart=e=>{e.preventDefault();let touch=e.touches[0];shoot(touch.clientX,touch.clientY);};window.onresize=()=>{init();};init();</script></body></html>
