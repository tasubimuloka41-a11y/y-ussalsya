<!DOCTYPE html><html><head><title>Bubble Shooter Premium</title><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><style>*{margin:0;padding:0;box-sizing:border-box}body{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);font-family:Arial,sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh;overflow:hidden}#gameContainer{text-align:center;background:#fff;border-radius:20px;padding:20px;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:slideIn .5s ease}@keyframes slideIn{from{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}#score{font-size:32px;font-weight:bold;color:#333;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.2);transition:transform .2s}#score.pulse{animation:pulse .3s}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}#canvas{background:#f0f4f8;border:3px solid #333;border-radius:15px;display:block;cursor:crosshair}#nextBubble{margin-top:15px;font-size:18px;font-weight:bold;color:#666}#nextPreview{width:60px;height:60px;margin:10px auto;border:3px solid #333;border-radius:50%;transition:transform .3s}#nextPreview:hover{transform:scale(1.1)}</style></head><body><div id="gameContainer"><div id="score">Очки: 0</div><canvas id="canvas" width="480" height="640"></canvas><div id="nextBubble">Следующий:</div><div id="nextPreview"></div></div><script>const canvas=document.getElementById('canvas');const ctx=canvas.getContext('2d');const scoreEl=document.getElementById('score');const nextPreview=document.getElementById('nextPreview');const CONFIG={BALL_RADIUS:20,COLORS:['#FF6B6B','#4ECDC4','#45B7D1','#FFD93D','#6BCF7F','#C77DFF'],ROWS:8,COLS:11,SHOOTER_Y:canvas.height-40};let score=0;let balls=[];let currentBall=null;let nextBall=null;let angle=-Math.PI/2;let shooting=false;let particles=[];let stars=[];const audioCtx=new(window.AudioContext||window.webkitAudioContext)();function playSound(freq,dur){const osc=audioCtx.createOscillator();const gain=audioCtx.createGain();osc.connect(gain);gain.connect(audioCtx.destination);osc.frequency.value=freq;gain.gain.setValueAtTime(.3,audioCtx.currentTime);gain.gain.exponentialRampToValueAtTime(.01,audioCtx.currentTime+dur);osc.start(audioCtx.currentTime);osc.stop(audioCtx.currentTime+dur)}class Particle{constructor(x,y,color){this.x=x;this.y=y;this.vx=(Math.random()-.5)*8;this.vy=(Math.random()-.5)*8-2;this.life=1;this.color=color;this.size=Math.random()*4+2}update(){this.x+=this.vx;this.y+=this.vy;this.vy+=.2;this.life-=.02;return this.life>0}draw(){ctx.save();ctx.globalAlpha=this.life;ctx.fillStyle=this.color;ctx.beginPath();ctx.arc(this.x,this.y,this.size,0,Math.PI*2);ctx.fill();ctx.restore()}}class Star{constructor(){this.x=Math.random()*canvas.width;this.y=Math.random()*canvas.height;this.size=Math.random()*2+1;this.speed=Math.random()*.5+.1}update(){this.y+=this.speed;if(this.y>canvas.height)this.y=0}draw(){ctx.fillStyle='rgba(255,255,255,0.5)';ctx.beginPath();ctx.arc(this.x,this.y,this.size,0,Math.PI*2);ctx.fill()}}class Ball{constructor(x,y,color,row=null,col=null){this.x=x;this.y=y;this.vx=0;this.vy=0;this.color=color;this.radius=CONFIG.BALL_RADIUS;this.row=row;this.col=col}draw(){ctx.save();ctx.fillStyle='rgba(0,0,0,0.2)';ctx.beginPath();ctx.arc(this.x+3,this.y+3,this.radius,0,Math.PI*2);ctx.fill();const gradient=ctx.createRadialGradient(this.x-5,this.y-5,0,this.x,this.y,this.radius);gradient.addColorStop(0,this.color);gradient.addColorStop(.7,this.color);gradient.addColorStop(1,'rgba(0,0,0,0.3)');ctx.fillStyle=gradient;ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.fill();ctx.strokeStyle='#333';ctx.lineWidth=2;ctx.stroke();ctx.fillStyle='rgba(255,255,255,0.4)';ctx.beginPath();ctx.arc(this.x-6,this.y-6,7,0,Math.PI*2);ctx.fill();ctx.restore()}update(){this.x+=this.vx;this.y+=this.vy;if(this.x-this.radius<0||this.x+this.radius>canvas.width){this.vx*=-1;this.x=Math.max(this.radius,Math.min(canvas.width-this.radius,this.x))}}}function initStars(){for(let i=0;i<50;i++)stars.push(new Star())}function drawBackground(){const gradient=ctx.createLinearGradient(0,0,0,canvas.height);gradient.addColorStop(0,'#e3f2fd');gradient.addColorStop(1,'#bbdefb');ctx.fillStyle=gradient;ctx.fillRect(0,0,canvas.width,canvas.height);stars.forEach(s=>{s.update();s.draw()})}function getGridPosition(x,y){const row=Math.floor(y/(CONFIG.BALL_RADIUS*Math.sqrt(3)));const offsetX=(row%2)*CONFIG.BALL_RADIUS;const col=Math.floor((x-offsetX)/(CONFIG.BALL_RADIUS*2));return{row,col}}function getScreenPosition(row,col){const offsetX=(row%2)*CONFIG.BALL_RADIUS;const x=col*CONFIG.BALL_RADIUS*2+CONFIG.BALL_RADIUS+offsetX;const y=row*CONFIG.BALL_RADIUS*Math.sqrt(3)+CONFIG.BALL_RADIUS;return{x,y}}function initBalls(){balls=[];for(let row=0;row<5;row++){for(let col=0;col<CONFIG.COLS;col++){const pos=getScreenPosition(row,col);if(pos.x-CONFIG.BALL_RADIUS>=0&&pos.x+CONFIG.BALL_RADIUS<=canvas.width){const color=CONFIG.COLORS[Math.floor(Math.random()*CONFIG.COLORS.length)];balls.push(new Ball(pos.x,pos.y,color,row,col))}}}}function createNewBall(){const color=CONFIG.COLORS[Math.floor(Math.random()*CONFIG.COLORS.length)];return new Ball(canvas.width/2,CONFIG.SHOOTER_Y,color)}function shoot(){if(shooting||!currentBall)return;shooting=true;const speed=12;currentBall.vx=Math.cos(angle)*speed;currentBall.vy=Math.sin(angle)*speed;playSound(440,.1)}function findMatches(ball){const matches=[ball];const checked=new Set();const queue=[ball];while(queue.length>0){const current=queue.shift();checked.add(current);for(const other of balls){if(checked.has(other)||other.color!==ball.color)continue;const dx=current.x-other.x;const dy=current.y-other.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<CONFIG.BALL_RADIUS*2.5){matches.push(other);queue.push(other);checked.add(other)}}}return matches}function createExplosion(x,y,color){for(let i=0;i<12;i++){particles.push(new Particle(x,y,color))}}function checkCollision(){if(!currentBall||!shooting)return;if(currentBall.y-currentBall.radius<=0){snapToGrid();return}for(const ball of balls){const dx=currentBall.x-ball.x;const dy=currentBall.y-ball.y;const dist=Math.sqrt(dx*dx+dy*dy);if(dist<CONFIG.BALL_RADIUS*2){snapToGrid();return}}}function snapToGrid(){const gridPos=getGridPosition(currentBall.x,currentBall.y);const screenPos=getScreenPosition(gridPos.row,gridPos.col);currentBall.x=screenPos.x;currentBall.y=screenPos.y;currentBall.vx=0;currentBall.vy=0;currentBall.row=gridPos.row;currentBall.col=gridPos.col;balls.push(currentBall);const matches=findMatches(currentBall);if(matches.length>=3){playSound(880,.2);balls=balls.filter(b=>!matches.includes(b));score+=matches.length*10;scoreEl.textContent='Очки: '+score;scoreEl.classList.add('pulse');setTimeout(()=>scoreEl.classList.remove('pulse'),300);matches.forEach(m=>createExplosion(m.x,m.y,m.color))}else{playSound(220,.1)}currentBall=nextBall;nextBall=createNewBall();updateNextPreview();shooting=false}function updateNextPreview(){if(nextBall)nextPreview.style.background=nextBall.color}function drawTrajectory(){if(shooting)return;ctx.save();ctx.fillStyle='rgba(255,255,255,0.6)';const dotCount=5;for(let i=1;i<=dotCount;i++){const dist=i*40;const x=canvas.width/2+Math.cos(angle)*dist;const y=CONFIG.SHOOTER_Y+Math.sin(angle)*dist;if(y<0||x<0||x>canvas.width)break;ctx.beginPath();ctx.arc(x,y,3,0,Math.PI*2);ctx.fill()}ctx.restore()}function gameLoop(){drawBackground();for(const ball of balls)ball.draw();if(currentBall){if(shooting){currentBall.update();checkCollision()}currentBall.draw()}particles=particles.filter(p=>{const alive=p.update();if(alive)p.draw();return alive});drawTrajectory();requestAnimationFrame(gameLoop)}canvas.addEventListener('mousemove',e=>{if(shooting)return;const rect=canvas.getBoundingClientRect();const mouseX=e.clientX-rect.left;const mouseY=e.clientY-rect.top;angle=Math.atan2(mouseY-CONFIG.SHOOTER_Y,mouseX-canvas.width/2);angle=Math.max(-Math.PI+.1,Math.min(-.1,angle))});canvas.addEventListener('click',shoot);initStars();initBalls();currentBall=createNewBall();nextBall=createNewBall();updateNextPreview();gameLoop()</script></body></html>
